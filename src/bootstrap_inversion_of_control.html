<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Foundry Bootstrap: Using Inversion of Control</title>
</head>
<body>

<div data-modules="welcome" data-module-options='{"backgroundColor": "#dcdcff"}'></div>

<!-- Class Libraries -->
<script type="text/javascript" src="./vendor/inherit.js/lib/function.js"></script>
<script type="text/javascript" src="./vendor/callbacks/src/callbacks.js"></script>
<script type="text/javascript" src="./vendor/callbacks/src/callbacks/utils.js"></script>
<script type="text/javascript" src="./vendor/dom_event_delegator/lib/dom/events/delegator.js"></script>
<script type="text/javascript" src="./vendor/element_store/lib/element_store.js"></script>
<script type="text/javascript" src="./vendor/element_store/lib/element_store/utils.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events/dispatcher.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events/event.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events/publisher.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events/application_events.js"></script>
<script type="text/javascript" src="./vendor/events/lib/events/notifications.js"></script>
<script type="text/javascript" src="./vendor/hash/lib/hash.js"></script>
<script type="text/javascript" src="./vendor/hypodermic/src/hypodermic.js"></script>

<!-- Base Framework -->
<script type="text/javascript" src="./vendor/module_controller/lib/module.js"></script>
<script type="text/javascript" src="./vendor/module_controller/lib/module/factory.js"></script>
<script type="text/javascript" src="./vendor/module_controller/lib/module/manager.js"></script>
<script type="text/javascript" src="./vendor/module_controller/lib/module/manager/lazy_loader.js"></script>
<script type="text/javascript" src="./vendor/module_controller/lib/module/manager/sub_module_properties.js"></script>
<script type="text/javascript" src="./vendor/promise/lib/promise.js"></script>
<script type="text/javascript" src="./vendor/foundry/src/application.js"></script>

<!-- Application Files -->
<script type="text/javascript" src="./app/modules/welcome_module.js"></script>

<!-- Bootstrapping Code -->
<script type="text/javascript">

(function(window, document) {

	// Wire your class dependencies up here
	var DependencyConfig = {
		// Base dependency config for the framework:
		application: {
			className: "Application",
			singleton: true,
			properties: {
				config: { id: "applicationConfig" },
				delegator: { id: "delegator" },
				elementStore: { id: "elementStore" },
				eventDispatcher: { id: "globalEventDispatcher" },
				moduleManager: { id: "moduleManager" },
				objectFactory: { id: "objectFactory" }
			}
		},
		applicationConfig: {
			className: "Hash",
			singleton: true,
			constructorArgs: [{
				value: {
					// Error handling:
					handleActionErrors: true,
					handleApplicationErrors: false,

					// Modules
					eagerLoadModules: true,
					lazyLoadModules: true
				}
			}]
		},
		delegator: {
			className: "dom.events.Delegator"
		},
		elementStore: {
			className: "ElementStore"
		},
		globalEventDispatcher: {
			className: "Events.Dispatcher",
			singleton: true
		},
		module: {
			abstract: true,
			properties: {
				delegator: { id: "delegator" },
				elementStore: { id: "elementStore" },
				eventDispatcher: { id: "globalEventDispatcher" },
				options: { id: "moduleOptions" }
			}
		},
		moduleFactory: {
			className: "Module.Factory",
			singleton: true,
			properties: {
				objectFactory: { id: "objectFactory" }
			}
		},
		moduleManager: {
			className: "Module.Manager",
			singleton: true,
			properties: {
				factory: { id: "moduleFactory" }
			}
		},
		moduleOptions: {
			className: "Hash",
			constructorArgs: [{
				value: {
					// Global default module options go here
				}
			}]
		},

		// Modules and other classes for your application:
		welcome: {
			className: "WelcomeModule",
			parent: "module"
		}

	};

	var objectFactory = new Hypodermic(DependencyConfig);
	window.app = objectFactory.getInstance("application");

	app.configure(function(config) {
		// Custom config settings go here
	});

	window.onload = function() {
		app.init(document.getElementsByTagName("html")[0]);
	};

})(window, document);

</script>
</body>
</html>
